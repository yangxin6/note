---
title: k邻近算法
date: 2021-09-07 22:00:00
permalink: /pages/DAt3JJ
categories: 
  - 机器学习
tags: 
  - kNN
author: 
  name: yangxin
  link: https://github.com/yangxin6/3DPointCloud
---

# 概念

KNN（k Near Neighbor）: k个最近的邻居，即每个样本都可以用它最近的k个邻居来代表。

<img src="https://cdn.jsdelivr.net/gh/yangxin6/img-hosting@master/images/knn0.35l4lhif67g0.png" alt="knn0" style="zoom:75%;" />

k近邻算法是一种**基本分类和回归方法**。本篇文章只讨论分类问题的k近邻法。

**算法思想**：一个样本与数据集中的 k 个样本最详细，如果这 k 个样本中的大多数属于某一个类别，则该样本也属于这个类别。

# 距离

**2个样本的相似性采用<mark>距离</mark>进行度量。**

$L_p$距离定义：

$L_(x_i,x_j)=(\sum \limits_{l=1}^n|x_i^{(l)} - x_j^{(l)}|^p)^{\frac{1}{p}}$

其中， $x_i \in R^n, x_j\in R^n$， $L_\infty(x_i,x_j) = \max \limits_l |x_i^{(l)} - x_j^{(l)}|$

![l](https://cdn.jsdelivr.net/gh/yangxin6/img-hosting@master/images/l.5cc3pvitezg0.png)

# 流程

- 计算已知类别数据集中的点与当前点之间的距离
- 按距离递增次序排序
- 选取与当前点距离最小的 k 个点
- 统计前 k 个点坐在的类别出现的频率
- 返回前 k 个点出现频率最高的类别作为当前点的预测分类



# 实例



## 电影分类预测

<img src="https://cdn.jsdelivr.net/gh/yangxin6/img-hosting@master/images/kn1.45icqojxf9k0.png" alt="kn1" style="zoom:50%;" />

<img src="https://cdn.jsdelivr.net/gh/yangxin6/img-hosting@master/images/kn2.56tp51bb7kk0.png" alt="kn2" style="zoom:50%;" />

[代码](https://github.com/yangxin6/MechineLearning/blob/master/lesson2/kNN.py)

## kd Tree

详情见[博客](https://yangxin6.github.io/blog/pages/79I6kK/#radius-search%E6%90%9C%E7%B4%A2)

